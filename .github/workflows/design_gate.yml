name: "Design Gate"

on:
  push:
    paths:
      - ".github/workflows/design_gate.yml"
      - "design/**"
      - "docs/design/**"
  pull_request:
    paths:
      - ".github/workflows/design_gate.yml"
      - "design/**"
      - "docs/design/**"
  workflow_dispatch:

jobs:
  gate:
    name: "Design Gate: validate"
    runs-on: ubuntu-latest
    steps:
      - name: "Checkout"
        uses: actions/checkout@v4

      - name: "Fail-closed: ensure design artifacts exist (if expected)"
        shell: bash
        run: |
          set -euo pipefail
          # 디자인 폴더가 아예 없는 레포면 이 체크는 통과시키고 싶을 수 있음.
          # fail-closed로 강제하고 싶으면 아래 주석을 해제.
          #
          # if [ ! -d "design" ] && [ ! -d "docs/design" ]; then
          #   echo "Fail-Closed: design/ or docs/design/ directory not found"
          #   exit 1
          # fi
          echo "OK"

      - name: "Sanity: workflow YAML parses"
        shell: bash
        run: |
          set -euo pipefail
          python - <<'PY'
          import yaml
          p=".github/workflows/design_gate.yml"
          yaml.safe_load(open(p, "r", encoding="utf-8"))
          print("OK: design_gate.yml parses")
          PY
